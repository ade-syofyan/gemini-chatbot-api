<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gemini AI Chatbot</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class", // Mengaktifkan mode gelap berdasarkan kelas 'dark' pada elemen HTML atau body
        // Memperbarui palet warna untuk tampilan yang lebih modern dan kohesif
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "Arial", "sans-serif"], // Menggunakan font Inter sebagai default
            },
            colors: {
              // Warna Aksen Utama (Biru)
              "accent-blue": {
                DEFAULT: "#3B82F6", // Tailwind's blue-500
                dark: "#60A5FA", // Tailwind's blue-400 untuk kontras di dark mode
                hover: "#2563EB", // Tailwind's blue-600
                darkHover: "#3B82F6", // Tailwind's blue-500
              },

              // Warna Latar Belakang Umum
              "bg-light": "#F9FAFB", // Latar belakang terang
              "bg-dark": "#1F2937", // Latar belakang gelap

              // Warna Permukaan (Main Content Area, Card, dll.)
              "surface-light": "#FFFFFF", // Permukaan terang
              "surface-dark": "#374151", // Permukaan gelap

              // Warna Latar Belakang Sidebar
              "sidebar-light": "#F3F4F6", // Sidebar terang
              "sidebar-dark": "#111827", // Sidebar gelap

              // Warna Teks
              "text-primary-light": "#1F2937", // Teks utama terang
              "text-primary-dark": "#F9FAFB", // Teks utama gelap
              "text-secondary-light": "#6B7280", // Teks sekunder terang
              "text-secondary-dark": "#9CA3AF", // Teks sekunder gelap

              // Warna Border
              "border-light": "#E5E7EB", // Border terang
              "border-dark": "#4B5563", // Border gelap

              // Warna Gelembung Chat
              "bubble-user-light": "#3B82F6", // Gelembung user terang (biru aksen)
              "bubble-user-dark": "#60A5FA", // Gelembung user gelap (biru aksen lebih terang)
              "bubble-bot-light": "#E5E7EB", // Gelembung bot terang (abu-abu terang)
              "bubble-bot-dark": "#4B5563", // Gelembung bot gelap (abu-abu gelap)

              // Warna Teks Gelembung Chat
              "text-user-light": "#FFFFFF", // Teks user terang
              "text-user-dark": "#FFFFFF", // Teks user gelap
              "text-bot-light": "#1F2937", // Teks bot terang
              "text-bot-dark": "#F9FAFB", // Teks bot gelap

              // Warna Ikon dan Hover
              "icon-default-light": "#6B7280", // Warna ikon default terang
              "icon-default-dark": "#9CA3AF", // Warna ikon default gelap
              "icon-hover-light": "#E5E7EB", // Latar belakang hover ikon terang
              "icon-hover-dark": "#4B5563", // Latar belakang hover ikon gelap
            },
          },
        },
      };
    </script>
    <!-- highlight.js for syntax highlighting -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </head>
  <!-- Body with Tailwind classes for base layout and dark/light mode -->
  <body
    class="font-sans bg-bg-light text-text-primary-light m-0 p-0 flex h-screen overflow-hidden dark:bg-bg-dark dark:text-text-primary-dark"
  >
    <div class="relative flex w-full h-full transition-all duration-300 ease-in-out">
      <!-- Sidebar -->
      <aside
        id="sidebar"
        class="fixed inset-y-0 left-0 z-40 w-64 bg-sidebar-light flex flex-col border-r border-border-light transition-transform duration-300 ease-in-out flex-shrink-0 dark:bg-sidebar-dark dark:border-border-dark transform -translate-x-full md:relative md:translate-x-0 shadow-lg"
      >
        <!-- Header for expanded state -->
        <div
          id="sidebar-header-expanded"
          class="p-4 flex justify-between items-center border-b border-border-light dark:border-border-dark"
        >
          <!-- Toggle Sidebar Button (Minimize Menu) - Menggunakan SVG untuk ikon hamburger -->
          <button
            id="toggle-sidebar-btn-expanded"
            class="bg-transparent border border-border-light text-icon-default-light cursor-pointer rounded-md w-8 h-8 flex items-center justify-center shadow-sm hover:bg-icon-hover-light transition-colors duration-200 dark:border-border-dark dark:text-icon-default-dark dark:hover:bg-icon-hover-dark"
            title="Toggle sidebar"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
          <!-- New Chat Button -->
          <button
            id="new-chat-btn"
            class="flex-grow text-left bg-transparent border border-border-light text-text-primary-light py-2 px-4 rounded-md cursor-pointer ml-2 shadow-sm hover:bg-icon-hover-light hover:text-text-primary-light transition-colors duration-200 dark:border-border-dark dark:text-text-primary-dark dark:hover:bg-icon-hover-dark"
          >
            <span class="mr-2">+</span> New Chat
          </button>
        </div>

        <!-- Search Bar for expanded state -->
        <div id="search-container" class="p-4 border-b border-border-light dark:border-border-dark">
          <input
            type="text" id="search-history-input" placeholder="Cari riwayat..."
            class="w-full p-2 rounded-md border border-border-light bg-surface-light text-text-primary-light focus:outline-none focus:ring-2 focus:ring-accent-blue dark:bg-surface-dark dark:border-border-dark dark:text-text-primary-dark dark:focus:ring-accent-blue-dark"
          />
        </div>

        <!-- Header for collapsed state -->
        <div
          id="sidebar-header-collapsed"
          class="p-4 flex-col items-center border-b border-border-light dark:border-border-dark hidden"
        >
          <button
            id="toggle-sidebar-btn-collapsed"
            class="bg-transparent border border-border-light text-icon-default-light cursor-pointer rounded-md w-8 h-8 flex items-center justify-center shadow-sm hover:bg-icon-hover-light transition-colors duration-200 dark:border-border-dark dark:text-icon-default-dark dark:hover:bg-icon-hover-dark mb-4"
            title="Toggle sidebar"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
          <button
            id="new-chat-icon-btn"
            class="bg-transparent border border-border-light text-icon-light cursor-pointer rounded-full w-8 h-8 flex items-center justify-center shadow-sm hover:bg-icon-hover-light transition-colors duration-200 dark:border-border-dark dark:text-icon-dark dark:hover:bg-icon-hover-dark"
          >
            <span class="text-xl">+</span>
            <!-- Plus icon for new chat -->
          </button>
        </div>

        <!-- Chat History -->
        <nav
          id="chat-history-list"
          class="flex-grow overflow-y-auto p-4 transition-opacity duration-300"
        >
          <ul>
            <!-- Chat history items will be populated by JavaScript -->
          </ul>
        </nav>
        <!-- Sidebar Footer (for dark/light mode toggle) -->
        <div
          id="sidebar-footer"
          class="p-4 border-t border-border-light dark:border-border-dark transition-opacity duration-300 flex justify-center"
        >
          <!-- Dark/Light Mode Toggle Switch -->
          <label
            for="theme-toggle-switch"
            class="flex items-center cursor-pointer"
          >
            <div class="relative">
              <input type="checkbox" id="theme-toggle-switch" class="sr-only peer" />
              <div
                class="block bg-text-secondary-light w-14 h-8 rounded-full transition-colors duration-300 peer-checked:bg-accent-blue dark:bg-surface-dark"
              ></div>
              <div
                class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform duration-300 flex items-center justify-center"
              >
                <!-- Moon Icon (for dark mode) -->
                <svg
                  id="moon-icon"
                  class="h-4 w-4 text-text-primary-light dark:text-yellow-400 hidden"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                  />
                </svg>
                <!-- Sun Icon (for light mode) -->
                <svg
                  id="sun-icon"
                  class="h-4 w-4 text-yellow-500 dark:text-text-primary-light"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 3v1m0 16v1m9-9h1M4 12H3m15.325 5.232l-.707.707M6.343 6.343l-.707-.707m12.728 0l-.707-.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                  />
                </svg>
              </div>
            </div>            
            <div id="theme-label" class="ml-3 text-text-primary-light dark:text-text-primary-dark font-medium">
              Mode Terang
            </div>
          </label>
        </div>
      </aside>

      <!-- Main Chat Container -->
      <main
        id="main-container" 
        class="flex-grow flex flex-col h-screen p-5 bg-bg-light dark:bg-bg-dark justify-center"
      >
        <!-- Mobile Header -->
        <header class="flex items-center justify-between mb-5 md:hidden">
          <button id="mobile-menu-btn" class="p-2 rounded-md text-icon-light dark:text-icon-dark hover:bg-icon-hover-light dark:hover:bg-icon-hover-dark">
            <!-- Hamburger Icon -->
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </button>
          <h1 class="text-xl font-bold text-center text-text-primary-light dark:text-text-primary-dark">
            Gemini AI
          </h1>
          <div class="w-8"></div> <!-- Spacer to center the title -->
        </header>

        <!-- Desktop Header (Now independent and always visible on desktop) -->
        <h1
          class="hidden md:block text-3xl font-bold text-center mb-5 text-text-light dark:text-text-dark"
        >
          Gemini AI Chatbot
        </h1>

        <!-- Welcome View (shown before a chat starts) -->
        <div id="welcome-view" class="text-center flex flex-col items-center">
          <h2 class="text-4xl font-bold mb-4 bg-gradient-to-r from-accent-blue to-purple-600 text-transparent bg-clip-text">
            Apa yang sedang Anda pikirkan?
          </h2>
        </div>

        <!-- Chat Box, initially hidden -->
        <div
          id="chat-box"
          class="flex-grow overflow-y-auto p-4 border border-border-light rounded-lg bg-surface-light mb-4 flex flex-col gap-3 hidden dark:border-border-dark dark:bg-surface-dark"
        ></div>
        <!-- Chat Input Form -->
        <form id="chat-form" class="flex gap-3 w-full max-w-3xl mx-auto">
          <input
            type="text"
            id="user-input"
            placeholder="Ketik pesan Anda..."
            autocomplete="off"
            required
            class="flex-grow p-3 rounded-lg border border-border-light text-text-primary-light focus:outline-none focus:ring-2 focus:ring-accent-blue dark:border-border-dark dark:bg-surface-dark dark:text-text-primary-dark dark:focus:ring-accent-blue-dark"
          />
          <button
            type="submit"
            aria-label="Kirim Pesan"
            class="w-12 h-12 flex items-center justify-center border-none bg-accent-blue text-white rounded-full cursor-pointer transition-colors duration-200 shadow-md hover:bg-accent-blue-hover dark:bg-accent-blue-dark dark:hover:bg-accent-blue-darkHover"
          >
            <!-- Send Icon -->
            <svg id="send-icon" class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
            <!-- Stop Icon (initially hidden) -->
            <svg id="stop-icon" class="w-6 h-6 hidden" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M6 6h12v12H6z"></path></svg>
          </button>
        </form>
      </main>
    </div>

    <!-- Overlay for mobile sidebar -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden md:hidden"></div>

    <!-- Confirmation Delete Modal -->
    <div
      id="confirm-modal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden"
    >
      <div
        class="bg-surface-light dark:bg-surface-dark rounded-lg p-6 shadow-xl max-w-sm w-full"
      >
        <h3 class="text-lg font-bold mb-4 text-text-primary-light dark:text-text-primary-dark">
          Konfirmasi Penghapusan
        </h3>
        <p class="mb-6 text-text-secondary-light dark:text-text-secondary-dark">
          Apakah Anda yakin ingin menghapus riwayat chat ini?
        </p>
        <div class="flex justify-end gap-3">
          <button
            id="cancel-delete-btn"
            class="py-2 px-4 rounded-md border border-border-light dark:border-border-dark text-text-primary-light dark:text-text-primary-dark hover:bg-icon-hover-light dark:hover:bg-icon-hover-dark transition-colors duration-200"
          >
            Batal
          </button>
          <button
            id="confirm-delete-btn"
            class="py-2 px-4 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors duration-200"
          >
            Hapus
          </button>
        </div>
      </div>
    </div>

    <script src="./script.js" type="module"></script>
  </body>
</html>
