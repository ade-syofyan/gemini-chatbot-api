<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gemini AI Chatbot</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class", // Mengaktifkan mode gelap berdasarkan kelas 'dark' pada elemen HTML atau body
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "Arial", "sans-serif"], // Menggunakan font Inter sebagai default
            },
            colors: {
              // Mendefinisikan palet warna kustom atau menggunakan warna bawaan Tailwind
              "primary-blue": "#0d6efd",
              "primary-blue-hover": "#0b5ed7",
              "gray-bg-light": "#f0f2f5",
              "main-bg-light": "#ffffff",
              "sidebar-bg-light": "#f8f9fa",
              "text-light": "#333",
              "border-light": "#ddd",
              "user-msg-light": "#0d6efd",
              "bot-msg-light": "#e9e9eb",
              "bot-msg-text-light": "#333",
              "secondary-text-light": "#6c757d",
              "icon-light": "#6c757d",
              "icon-hover-light": "#e9ecef",

              "dark-bg": "#121212",
              "main-bg-dark": "#1e1e1e",
              "sidebar-bg-dark": "#252526",
              "text-dark": "#e0e0e0",
              "border-dark": "#444",
              "button-dark": "#377dff",
              "button-hover-dark": "#1a66ff",
              "user-msg-dark": "#377dff",
              "bot-msg-dark": "#3a3a3a",
              "bot-msg-text-dark": "#e0e0e0",
              "secondary-text-dark": "#a0a0a0",
              "icon-dark": "#a0a0a0",
              "icon-hover-dark": "#3a3a3a",
            },
          },
        },
      };
    </script>
    <!-- highlight.js for syntax highlighting -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </head>
  <!-- Body with Tailwind classes for base layout and dark/light mode -->
  <body
    class="font-sans bg-gray-bg-light text-text-light m-0 p-0 flex h-screen overflow-hidden dark:bg-dark-bg dark:text-text-dark"
  >
    <div class="flex w-full h-full transition-all duration-300 ease-in-out">
      <!-- Sidebar -->
      <aside
        id="sidebar"
        class="w-64 bg-sidebar-bg-light flex flex-col border-r border-border-light transition-all duration-300 ease-in-out flex-shrink-0 dark:bg-sidebar-bg-dark dark:border-border-dark"
      >
        <!-- Header for expanded state -->
        <div
          id="sidebar-header-expanded"
          class="p-4 flex justify-between items-center border-b border-border-light dark:border-border-dark"
        >
          <!-- Toggle Sidebar Button (Minimize Menu) -->
          <button
            id="toggle-sidebar-btn-expanded"
            class="bg-transparent border border-border-light text-icon-light cursor-pointer rounded-md w-8 h-8 flex items-center justify-center shadow-sm hover:bg-icon-hover-light transition-colors duration-200 dark:border-border-dark dark:text-icon-dark dark:hover:bg-icon-hover-dark"
            title="Toggle sidebar"
          >
            &#9776;
            <!-- Hamburger icon -->
          </button>
          <!-- New Chat Button -->
          <button
            id="new-chat-btn"
            class="flex-grow text-left bg-transparent border border-border-light text-text-light py-2 px-4 rounded-md cursor-pointer ml-2 shadow-sm hover:bg-icon-hover-light hover:text-text-light transition-colors duration-200 dark:border-border-dark dark:text-text-dark dark:hover:bg-icon-hover-dark"
          >
            <span class="mr-2">+</span> New Chat
          </button>
        </div>

        <!-- Header for collapsed state -->
        <div
          id="sidebar-header-collapsed"
          class="p-4 flex-col items-center border-b border-border-light dark:border-border-dark hidden"
        >
          <button
            id="toggle-sidebar-btn-collapsed"
            class="bg-transparent border border-border-light text-icon-light cursor-pointer rounded-md w-8 h-8 flex items-center justify-center shadow-sm hover:bg-icon-hover-light transition-colors duration-200 dark:border-border-dark dark:text-icon-dark dark:hover:bg-icon-hover-dark mb-4"
            title="Toggle sidebar"
          >
            &#9776;
            <!-- Hamburger icon -->
          </button>
          <button
            id="new-chat-icon-btn"
            class="bg-transparent border border-border-light text-icon-light cursor-pointer rounded-full w-8 h-8 flex items-center justify-center shadow-sm hover:bg-icon-hover-light transition-colors duration-200 dark:border-border-dark dark:text-icon-dark dark:hover:bg-icon-hover-dark"
          >
            <span class="text-xl">+</span>
            <!-- Plus icon for new chat -->
          </button>
        </div>

        <!-- Chat History -->
        <nav
          id="chat-history-list"
          class="flex-grow overflow-y-auto p-4 transition-opacity duration-300"
        >
          <ul>
            <!-- Chat history items will be populated by JavaScript -->
          </ul>
        </nav>
        <!-- Sidebar Footer (for dark/light mode toggle) -->
        <div
          id="sidebar-footer"
          class="p-4 border-t border-border-light dark:border-border-dark transition-opacity duration-300 flex justify-center"
        >
          <!-- Dark/Light Mode Toggle Switch -->
          <label
            for="theme-toggle-switch"
            class="flex items-center cursor-pointer"
          >
            <div class="relative">
              <input type="checkbox" id="theme-toggle-switch" class="sr-only" />
              <div
                class="block bg-gray-600 w-14 h-8 rounded-full transition-colors duration-300 dark:bg-gray-700"
              ></div>
              <div
                class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform duration-300 flex items-center justify-center"
              >
                <!-- Moon Icon (for dark mode) -->
                <svg
                  id="moon-icon"
                  class="h-4 w-4 text-gray-800 dark:text-yellow-400 hidden"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                  />
                </svg>
                <!-- Sun Icon (for light mode) -->
                <svg
                  id="sun-icon"
                  class="h-4 w-4 text-yellow-500 dark:text-gray-800"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 3v1m0 16v1m9-9h1M4 12H3m15.325 5.232l-.707.707M6.343 6.343l-.707-.707m12.728 0l-.707-.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                  />
                </svg>
              </div>
            </div>
            <div id="theme-label" class="ml-3 text-text-light dark:text-text-dark font-medium">
              Mode Terang
            </div>
          </label>
        </div>
      </aside>

      <!-- Main Chat Container -->
      <main
        class="flex-grow flex flex-col h-screen p-5 bg-gray-bg-light dark:bg-dark-bg"
      >
        <h1
          class="text-3xl font-bold text-center mb-5 text-text-light dark:text-text-dark"
        >
          Gemini AI Chatbot
        </h1>
        <!-- Chat Box, initially hidden -->
        <div
          id="chat-box"
          class="flex-grow overflow-y-auto p-4 border border-border-light rounded-lg bg-main-bg-light mb-4 flex flex-col gap-3 hidden dark:border-border-dark dark:bg-main-bg-dark"
        ></div>
        <!-- Chat Input Form -->
        <form id="chat-form" class="flex gap-3 mt-auto">
          <!-- Added mt-auto here -->
          <input
            type="text"
            id="user-input"
            placeholder="Ketik pesan Anda..."
            autocomplete="off"
            required
            class="flex-grow p-3 rounded-full border border-gray-300 text-text-light focus:outline-none focus:ring-2 focus:ring-primary-blue dark:border-gray-600 dark:bg-gray-700 dark:text-text-dark dark:focus:ring-button-dark"
          />
          <button
            type="submit"
            aria-label="Kirim Pesan"
            class="w-12 h-12 flex items-center justify-center border-none bg-primary-blue text-white rounded-full cursor-pointer transition-colors duration-200 shadow-md hover:bg-primary-blue-hover dark:bg-button-dark dark:hover:bg-button-hover-dark"
          >
            <!-- Send Icon -->
            <svg id="send-icon" class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
            <!-- Stop Icon (initially hidden) -->
            <svg id="stop-icon" class="w-6 h-6 hidden" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M6 6h12v12H6z"></path></svg>
          </button>
        </form>
      </main>
    </div>

    <!-- Confirmation Delete Modal -->
    <div
      id="confirm-modal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-xl max-w-sm w-full"
      >
        <h3 class="text-lg font-bold mb-4 text-text-light dark:text-text-dark">
          Konfirmasi Penghapusan
        </h3>
        <p class="mb-6 text-secondary-text-light dark:text-secondary-text-dark">
          Apakah Anda yakin ingin menghapus riwayat chat ini?
        </p>
        <div class="flex justify-end gap-3">
          <button
            id="cancel-delete-btn"
            class="py-2 px-4 rounded-md border border-gray-300 dark:border-gray-600 text-text-light dark:text-text-dark hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200"
          >
            Batal
          </button>
          <button
            id="confirm-delete-btn"
            class="py-2 px-4 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors duration-200"
          >
            Hapus
          </button>
        </div>
      </div>
    </div>

    <script src="./script.js" type="module"></script>
  </body>
</html>
